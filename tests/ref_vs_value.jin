fn extern "c" printf(fmt: *U8, ..) -> I32

fn main() = {
	unsafe printf("Reference semantics:\n".ptr)
	ref_type()
	unsafe printf("\n".ptr)

	unsafe printf("Value semantics (extern):\n".ptr)
	ext_type()
}

type Ref(field: Int)

fn ref_type() = {
	let mut r = Ref(1)
	print(&r) # should be 1

	r.field = 2
	print(&r) # should be 2

	r.mutate()
	print(&r) # should be 3
}

fn mutate(r: &mut Ref) = {
	r.field = 3
}

fn print(r: &Ref) = {
	unsafe printf("Ref(field: %d)\n".ptr, r.field)
}

type Ext extern(field: Int)

fn ext_type() = {
	let mut ext = Ext(1)
	print(ext) # should be 1

	ext.field = 2
	print(ext) # should be 2

	ext.mutate()
	print(ext) # should still be 2
}

fn mutate(mut ext: Ext) = {
	ext.field = 3
}

fn print(ext: Ext) = {
	unsafe printf("Ext(field: %d)\n".ptr, ext.field)	
}

