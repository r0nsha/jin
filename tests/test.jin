use extern "./foo"

fn extern "c" hello()
let extern answer: Int

fn extern "c" printf(fmt: ptr[U8], ..) -> I32

fn main() = {
	println("Hello, World!")
	unsafe hello()
	run(print_answer)
	do_add(add, 1, 2)
	unsafe printf("num = %d\n".data, map(1, id))
}

fn print_answer() = {
	unsafe printf("The answer is %d\n".data, answer)
}

fn add(a: Int, b: Int) -> Int = {
	a + b
}

fn do_add(f: fn(Int, Int) -> Int, a: Int, b: Int) = {
	unsafe printf("a + b = %d\n".data, f(a, b))
}

fn run(f: fn()) = f()

fn id[T](x: T) -> T = x

fn map[A, B](val: A, f: fn(A) -> B) -> B =
	f(val)
